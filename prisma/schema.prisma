generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ==================== æšä¸¾å®šä¹‰ ====================

// é¡µé¢ç±»å‹æšä¸¾
enum PageTypeEnum {
  GAME_LIST // æ¸¸æˆå¡ç‰‡åˆ—è¡¨é¡µ
  DISPLAY_PAGE // å±•ç¤ºé¡µé¢
  OTHER_PAGE // å…¶ä»–é¡µé¢
}

// æ–‡å­—æ–¹å‘æšä¸¾
enum TextDirection {
  LTR // Left-to-right (å·¦åˆ°å³ï¼šè‹±è¯­ã€ä¸­æ–‡ç­‰)
  RTL // Right-to-left (å³åˆ°å·¦ï¼šé˜¿æ‹‰ä¼¯è¯­ã€å¸Œä¼¯æ¥è¯­ç­‰)
}

// æ¸¸æˆçŠ¶æ€æšä¸¾
enum GameStatus {
  DRAFT // è‰ç¨¿
  PUBLISHED // å·²å‘å¸ƒ
  ARCHIVED // å·²å½’æ¡£
  MAINTENANCE // ç»´æŠ¤ä¸­
}

// URLæäº¤çŠ¶æ€æšä¸¾
enum SubmissionStatus {
  PENDING // å¾…æäº¤
  SUBMITTED // å·²æäº¤ï¼ˆç­‰å¾…å“åº”ï¼‰
  SUCCESS // æˆåŠŸ
  FAILED // å¤±è´¥
  RETRYING // é‡è¯•ä¸­
}

// æ‰¹é‡æäº¤ä»»åŠ¡çŠ¶æ€æšä¸¾
enum BatchStatus {
  PENDING // å¾…å¤„ç†
  PROCESSING // å¤„ç†ä¸­
  COMPLETED // å·²å®Œæˆ
  FAILED // å¤±è´¥
  CANCELLED // å·²å–æ¶ˆ
}

// åˆ é™¤æšä¸¾ï¼Œæ”¹ç”¨ String å­—æ®µå­˜å‚¨åŸå§‹ API è¿”å›å€¼

// ==================== æ•°æ®æ¨¡å‹ ====================

// æ¸¸æˆåˆ†ç±»ï¼ˆä¸»è¡¨ï¼‰
model Category {
  id        String  @id @default(cuid())
  slug      String  @unique
  icon      String? // åˆ†ç±»å›¾æ ‡ï¼ˆemojiæˆ–å›¾ç‰‡URLï¼‰
  sortOrder Int     @default(0) @map("sort_order")
  isEnabled Boolean @default(true) @map("is_enabled") // æ˜¯å¦å¯ç”¨

  // å±‚çº§å…³ç³»ï¼šçˆ¶åˆ†ç±»IDï¼ˆnullè¡¨ç¤ºä¸»åˆ†ç±»ï¼Œæœ‰å€¼è¡¨ç¤ºå­åˆ†ç±»ï¼‰
  parentId String? @map("parent_id")

  // è‹±æ–‡åŸºç¡€ä¿¡æ¯ï¼ˆä½œä¸ºå›é€€ï¼‰
  name        String // è‹±æ–‡åç§°ï¼šAction, Puzzle, Sports
  description String? // è‹±æ–‡æè¿°

  // SEO å­—æ®µï¼ˆè‹±æ–‡ï¼Œä½œä¸ºå›é€€ï¼‰
  metaTitle       String? @map("meta_title")
  metaDescription String? @map("meta_description")
  keywords        String? // SEO å…³é”®è¯

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  translations CategoryTranslation[]

  // è‡ªå¼•ç”¨å…³ç³»ï¼šä¸€ä¸ªä¸»åˆ†ç±»å¯ä»¥æœ‰å¤šä¸ªå­åˆ†ç±»
  parent        Category?  @relation("CategoryHierarchy", fields: [parentId], references: [id], onDelete: Cascade)
  subCategories Category[] @relation("CategoryHierarchy")

  // å¤šå¯¹å¤šå…³è”
  gameSubCategories  GameCategory[] @relation("GameSubCategories")
  gameMainCategories GameCategory[] @relation("GameMainCategories")

  @@index([slug])
  @@index([sortOrder])
  @@index([isEnabled])
  @@index([parentId])
  @@map("categories")
}

// åˆ†ç±»ç¿»è¯‘è¡¨
model CategoryTranslation {
  id              String  @id @default(cuid())
  categoryId      String  @map("category_id")
  locale          String
  name            String
  description     String?
  metaTitle       String? @map("meta_title")
  metaDescription String? @map("meta_description")
  keywords        String? // SEO å…³é”®è¯

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  category Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@unique([categoryId, locale])
  @@index([locale])
  @@map("category_translations")
}

// æ¸¸æˆæ ‡ç­¾ï¼ˆä¸»è¡¨ï¼‰
model Tag {
  id        String  @id @default(cuid())
  slug      String  @unique
  icon      String? // æ ‡ç­¾å›¾æ ‡ï¼ˆemojiæˆ–å›¾ç‰‡URLï¼‰
  isEnabled Boolean @default(true) @map("is_enabled") // æ˜¯å¦å¯ç”¨

  // è‹±æ–‡åŸºç¡€ä¿¡æ¯ï¼ˆä½œä¸ºå›é€€ï¼‰
  name        String // è‹±æ–‡åç§°ï¼šMultiplayer, Puzzle, Adventure
  description String? // è‹±æ–‡æè¿°

  // SEO å­—æ®µï¼ˆè‹±æ–‡ï¼Œä½œä¸ºå›é€€ï¼‰
  metaTitle       String? @map("meta_title")
  metaDescription String? @map("meta_description")
  keywords        String? // SEO å…³é”®è¯

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  games        GameTag[]
  translations TagTranslation[]

  @@index([slug])
  @@index([isEnabled])
  @@map("tags")
}

// æ ‡ç­¾ç¿»è¯‘è¡¨
model TagTranslation {
  id              String  @id @default(cuid())
  tagId           String  @map("tag_id")
  locale          String
  name            String
  description     String? // æ ‡ç­¾æè¿°
  metaTitle       String? @map("meta_title")
  metaDescription String? @map("meta_description")
  keywords        String? // SEO å…³é”®è¯

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  tag Tag @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@unique([tagId, locale])
  @@index([locale])
  @@map("tag_translations")
}

// æ¸¸æˆä¸»ä½“ï¼ˆä¸»è¡¨ - å­˜å‚¨è‹±æ–‡å†…å®¹ + éç¿»è¯‘å­—æ®µï¼‰
model Game {
  id   String @id @default(cuid())
  slug String @unique

  // ========== è‹±æ–‡åŸºç¡€ä¿¡æ¯ ==========
  title       String // è‹±æ–‡æ ‡é¢˜ï¼ˆå¿…éœ€ï¼‰
  description String? // è‹±æ–‡ç®€çŸ­æè¿°

  // ========== è‹±æ–‡ SEO ==========
  keywords        String? // SEO å…³é”®è¯
  metaTitle       String? @map("meta_title") // SEO æ ‡é¢˜
  metaDescription String? @map("meta_description") // SEO æè¿°

  // ========== åª’ä½“èµ„æº ==========
  thumbnail   String // ç¼©ç•¥å›¾ï¼ˆå¿…éœ€ï¼‰
  banner      String? // æ¨ªå¹…å›¾ï¼ˆå¯é€‰ï¼‰
  screenshots String[] @default([]) // æˆªå›¾æ•°ç»„
  videos      String[] @default([]) // è§†é¢‘æ•°ç»„
  embedUrl    String   @map("embed_url") // iframe åµŒå…¥åœ°å€
  gameUrl     String?  @map("game_url") // åŸå§‹é¡µé¢ URLï¼ˆå¯é€‰ï¼‰

  // ========== å°ºå¯¸é…ç½®ï¼ˆJSONï¼‰==========
  dimensions Json @default("{\"width\":800,\"height\":600,\"aspectRatio\":\"4:3\",\"orientation\":\"landscape\"}")

  // ========== çŠ¶æ€ ==========
  status     GameStatus @default(DRAFT) // æ¸¸æˆçŠ¶æ€ï¼ˆæšä¸¾ï¼‰
  isFeatured Boolean    @default(false) @map("is_featured")

  // ========== ç»Ÿè®¡æ•°æ® ==========
  playCount Int @default(0) @map("play_count")
  viewCount Int @default(0) @map("view_count")
  likes     Int @default(0) // èµçš„æ•°é‡
  dislikes  Int @default(0) // è¸©çš„æ•°é‡

  // ========== è¯„åˆ†ç³»ç»Ÿ ==========
  rating       Float  @default(0) // ç”¨æˆ·è¯„åˆ†ï¼ˆ1-5ï¼‰
  ratingCount  Int    @default(0) @map("rating_count")
  qualityScore Float? @map("quality_score") // GamePix è´¨é‡è¯„åˆ†ï¼ˆ0-10ï¼‰

  // ========== æ¥æºä¿¡æ¯ ==========
  sourcePlatform   String? @map("source_platform") // gamepix, crazygames, custom
  sourcePlatformId String? @map("source_platform_id") // namespace æˆ–å¹³å° ID

  // ========== å¼€å‘è€…ä¿¡æ¯ ==========
  developer    String? // å¼€å‘è€…åç§°
  developerUrl String? @map("developer_url") // å¼€å‘è€…ç½‘ç«™

  // ========== è‹±æ–‡è¯¦ç»†å†…å®¹ï¼ˆJSONï¼‰==========
  gameInfo Json? @map("game_info") // contentSections + faq + extras

  // ========== æ—¶é—´ç®¡ç† ==========
  releaseDate     DateTime? @map("release_date") // æ¸¸æˆåŸå§‹å‘å¸ƒæ—¥æœŸï¼ˆæ¥æºå¹³å°ï¼‰
  sourceUpdatedAt DateTime? @map("source_updated_at") // æ¥æºå¹³å°æœ€åæ›´æ–°æ—¶é—´
  importedAt      DateTime? @map("imported_at") // å¯¼å…¥åˆ°æœ¬ç«™çš„æ—¶é—´
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  // ========== å…³è”å…³ç³» ==========
  gameCategories GameCategory[]
  tags           GameTag[]
  translations   GameTranslation[]
  votes          GameVote[] // ç”¨æˆ·æŠ•ç¥¨è®°å½•

  @@index([slug])
  @@index([status])
  @@index([isFeatured])
  @@index([playCount])
  @@index([viewCount])
  @@index([likes])
  @@index([dislikes])
  @@index([releaseDate])
  @@index([importedAt])
  @@index([sourcePlatform])
  @@index([sourcePlatform, sourcePlatformId])
  @@index([qualityScore])
  @@index([developer])
  @@map("games")
}

// æ¸¸æˆç¿»è¯‘è¡¨ï¼ˆä»…å­˜å‚¨éè‹±æ–‡è¯­è¨€çš„ç¿»è¯‘ï¼‰
model GameTranslation {
  id     String @id @default(cuid())
  gameId String @map("game_id")
  locale String // zh, es, fr, de ç­‰ï¼ˆä¸åŒ…å« enï¼‰

  // ========== ç¿»è¯‘åŸºç¡€ä¿¡æ¯ ==========
  title       String // ç¿»è¯‘æ ‡é¢˜ï¼ˆå¿…éœ€ï¼‰
  description String? // ç¿»è¯‘ç®€çŸ­æè¿°

  // ========== ç¿»è¯‘ SEO ==========
  keywords        String? // SEO å…³é”®è¯
  metaTitle       String? @map("meta_title") // SEO æ ‡é¢˜
  metaDescription String? @map("meta_description") // SEO æè¿°

  // ========== ç¿»è¯‘è¯¦ç»†å†…å®¹ï¼ˆJSONï¼Œä¸ Game.gameInfo ç»“æ„ç›¸åŒï¼‰==========
  translationInfo Json? @map("translation_info") // contentSections + faq + extras

  // ========== æ—¶é—´æˆ³ ==========
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // ========== å…³è”å…³ç³» ==========
  game Game @relation(fields: [gameId], references: [id], onDelete: Cascade)

  @@unique([gameId, locale])
  @@index([locale])
  @@index([gameId])
  @@map("game_translations")
}

// æ¸¸æˆ-æ ‡ç­¾å…³è”è¡¨
model GameTag {
  gameId String @map("game_id")
  tagId  String @map("tag_id")
  game   Game   @relation(fields: [gameId], references: [id], onDelete: Cascade)
  tag    Tag    @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([gameId, tagId])
  @@index([gameId])
  @@index([tagId])
  @@map("game_tags")
}

// æ¸¸æˆ-åˆ†ç±»å…³è”è¡¨ï¼ˆå¤šå¯¹å¤šï¼‰
model GameCategory {
  id             String @id @default(cuid())
  gameId         String @map("game_id")
  categoryId     String @map("category_id") // å­åˆ†ç±»ID
  mainCategoryId String @map("main_category_id") // ä¸»åˆ†ç±»IDï¼ˆä¼˜åŒ–å­—æ®µï¼‰

  isPrimary Boolean  @default(false) @map("is_primary") // æ˜¯å¦ä¸ºä¸»è¦åˆ†ç±»
  sortOrder Int      @default(0) @map("sort_order") // æ’åº
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // å…³è”å…³ç³»
  game         Game     @relation(fields: [gameId], references: [id], onDelete: Cascade)
  category     Category @relation("GameSubCategories", fields: [categoryId], references: [id], onDelete: Cascade)
  mainCategory Category @relation("GameMainCategories", fields: [mainCategoryId], references: [id], onDelete: Restrict)

  @@unique([gameId, categoryId])
  @@index([gameId])
  @@index([categoryId])
  @@index([mainCategoryId])
  @@index([mainCategoryId, gameId])
  @@index([mainCategoryId, isPrimary])
  @@index([isPrimary])
  @@map("game_categories")
}

// é¡µé¢ç±»å‹ï¼ˆä¸»è¡¨ï¼‰
model PageType {
  id        String       @id @default(cuid())
  slug      String       @unique // é¡µé¢æ ‡è¯†ç¬¦ï¼šmost-played, trending, new ç­‰
  type      PageTypeEnum @default(GAME_LIST) // é¡µé¢ç±»å‹ï¼ˆæšä¸¾ï¼‰
  icon      String? // é¡µé¢å›¾æ ‡ï¼ˆemojiæˆ–å›¾ç‰‡URLï¼‰
  isEnabled Boolean      @default(true) @map("is_enabled")
  sortOrder Int          @default(0) @map("sort_order")

  // è‹±æ–‡åŸºç¡€ä¿¡æ¯ï¼ˆä½œä¸ºå›é€€ï¼‰
  title       String // è‹±æ–‡æ ‡é¢˜
  description String? // è‹±æ–‡æè¿°

  // SEO å­—æ®µï¼ˆè‹±æ–‡ï¼Œä½œä¸ºå›é€€ï¼‰
  metaTitle       String? @map("meta_title")
  metaDescription String? @map("meta_description")
  keywords        String? // SEO å…³é”®è¯

  // é¡µé¢é…ç½®ï¼ˆåŒ…å« gameList, displayPage, otherPage ä¸‰ä¸ªå¯é€‰å­—æ®µï¼‰
  pageInfo Json? @map("page_info") // é¡µé¢ç›¸å…³æ•°æ®é…ç½®

  // æ—¶é—´æˆ³
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // å…³è”å…³ç³»
  translations PageTypeTranslation[]

  @@index([slug])
  @@index([type])
  @@index([isEnabled])
  @@index([sortOrder])
  @@map("page_types")
}

// é¡µé¢ç±»å‹ç¿»è¯‘è¡¨
model PageTypeTranslation {
  id         String @id @default(cuid())
  pageTypeId String @map("page_type_id")
  locale     String

  // åŸºç¡€ä¿¡æ¯
  title       String // é¡µé¢æ ‡é¢˜ï¼ˆå¿…å¡«ï¼‰
  description String? // é¡µé¢æè¿°

  // SEO å…ƒä¿¡æ¯
  metaTitle       String? @map("meta_title")
  metaDescription String? @map("meta_description")
  keywords        String? // SEO å…³é”®è¯

  // é¡µé¢é…ç½®ï¼ˆç¿»è¯‘ç‰ˆæœ¬ï¼‰
  pageInfo Json? @map("page_info") // é¡µé¢ç›¸å…³æ•°æ®é…ç½®ï¼ˆç¿»è¯‘ç‰ˆï¼‰

  // æ—¶é—´æˆ³
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // å…³è”å…³ç³»
  pageType PageType @relation(fields: [pageTypeId], references: [id], onDelete: Cascade)

  @@unique([pageTypeId, locale])
  @@index([locale])
  @@map("page_type_translations")
}

// è¯­è¨€ç®¡ç†è¡¨ï¼ˆä¸»è¡¨ï¼‰
model Language {
  id         String        @id @default(cuid())
  code       String        @unique // ISO 639-1 è¯­è¨€ä»£ç ï¼šen, zh, es
  name       String // è‹±æ–‡åç§°ï¼ˆä½œä¸ºå›é€€ï¼‰ï¼šEnglish, Chinese, Spanish
  nativeName String        @map("native_name") // åŸç”Ÿè¯­è¨€åç§°ï¼šEnglish, ä¸­æ–‡, EspaÃ±ol
  flag       String? // æ——å¸œemojiï¼šğŸ‡¬ğŸ‡§, ğŸ‡¨ğŸ‡³, ğŸ‡ªğŸ‡¸
  localeCode String        @map("locale_code") // å®Œæ•´åŒºåŸŸä»£ç ï¼šen-US, zh-CN, es-ES
  direction  TextDirection @default(LTR) // æ–‡å­—æ–¹å‘ï¼ˆæšä¸¾ï¼‰
  isDefault  Boolean       @default(false) @map("is_default")
  isEnabled  Boolean       @default(true) @map("is_enabled")
  sortOrder  Int           @default(0) @map("sort_order")

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // å…³è”å…³ç³»
  translations LanguageTranslation[]

  @@index([code])
  @@index([isEnabled])
  @@index([isDefault])
  @@index([sortOrder])
  @@map("languages")
}

// è¯­è¨€ç¿»è¯‘è¡¨
model LanguageTranslation {
  id         String @id @default(cuid())
  languageId String @map("language_id")
  locale     String

  // ç¿»è¯‘ä¿¡æ¯
  name        String // ç¿»è¯‘åçš„è¯­è¨€åç§°
  description String? // è¯­è¨€æè¿°ï¼ˆå¯é€‰ï¼‰

  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // å…³è”å…³ç³»
  language Language @relation(fields: [languageId], references: [id], onDelete: Cascade)

  @@unique([languageId, locale])
  @@index([locale])
  @@map("language_translations")
}

// ç®¡ç†å‘˜ç”¨æˆ·
model Admin {
  id          String    @id @default(cuid())
  email       String    @unique
  password    String
  name        String?
  role        String    @default("ADMIN") // ADMIN, SUPER_ADMIN
  isActive    Boolean   @default(true) @map("is_active")
  lastLoginAt DateTime? @map("last_login_at")
  createdAt   DateTime  @default(now()) @map("created_at")
  updatedAt   DateTime  @updatedAt @map("updated_at")

  @@index([email])
  @@map("admins")
}

// å¯¼å…¥å¹³å°é…ç½®è¡¨
model ImportPlatform {
  id   String  @id @default(cuid())
  name String // å¹³å°åç§°ï¼ˆå¦‚ï¼šGamePix, CrazyGamesï¼‰
  slug String  @unique // å¹³å°æ ‡è¯†ï¼ˆå¦‚ï¼šgamepix, crazygamesï¼‰
  type String // å¹³å°ç±»å‹ï¼ˆgamepix, crazygames, customï¼‰
  icon String? // å¹³å°å›¾æ ‡

  // API é…ç½®
  apiConfig Json @map("api_config") // å¹³å° API é…ç½®ï¼ˆå¦‚ siteId, apiKey ç­‰ï¼‰

  // é»˜è®¤å¯¼å…¥é…ç½®
  defaultConfig Json? @default("{}") @map("default_config") // é»˜è®¤å¯¼å…¥é€‰é¡¹

  // çŠ¶æ€
  isEnabled Boolean @default(true) @map("is_enabled")
  sortOrder Int     @default(0) @map("sort_order")

  // ç»Ÿè®¡
  totalImported Int       @default(0) @map("total_imported") // æ€»å¯¼å…¥æ¸¸æˆæ•°
  lastImportAt  DateTime? @map("last_import_at") // æœ€åå¯¼å…¥æ—¶é—´

  // æ—¶é—´æˆ³
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@index([slug])
  @@index([isEnabled])
  @@index([sortOrder])
  @@map("import_platforms")
}

// AI é…ç½®è¡¨ï¼ˆç²¾ç®€ç‰ˆï¼‰
model AiConfig {
  id String @id @default(cuid())

  // åŸºæœ¬ä¿¡æ¯
  name     String // é…ç½®åç§°ï¼ˆå¦‚ï¼šOpenRouter - Gemini 2.0 Flashï¼‰
  provider String // æä¾›å•†æ ‡è¯†ï¼šopenrouter, openai, anthropic, custom

  // API é…ç½®
  apiKey  String @map("api_key") // API å¯†é’¥
  baseUrl String @map("base_url") // API ç«¯ç‚¹åœ°å€

  // æ¨¡å‹é…ç½®ï¼ˆJSON æ ¼å¼å­˜å‚¨æ‰€æœ‰æ¨¡å‹å’Œå‚æ•°ï¼‰
  modelConfig Json @map("model_config")
  // ç»“æ„ç¤ºä¾‹ï¼š
  // {
  //   "models": [
  //     {
  //       "id": "google/gemini-2.0-flash-exp:free",
  //       "name": "Gemini 2.0 Flash",
  //       "isDefault": true,
  //       "isEnabled": true,
  //       "parameters": {
  //         "temperature": 0.7,
  //         "max_tokens": 2000,
  //         "top_p": 1.0,
  //         "stream": true
  //       },
  //       "headers": {
  //         "HTTP-Referer": "https://rungame.online"
  //       }
  //     }
  //   ]
  // }

  // çŠ¶æ€
  isActive  Boolean @default(false) @map("is_active") // æ˜¯å¦ä¸ºå½“å‰æ¿€æ´»é…ç½®
  isEnabled Boolean @default(true) @map("is_enabled") // æ˜¯å¦å¯ç”¨

  // æ—¶é—´æˆ³
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@index([provider])
  @@index([isActive])
  @@index([isEnabled])
  @@map("ai_configs")
}

// ç½‘ç«™é…ç½®è¡¨ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
model SiteConfig {
  id String @id @default(cuid())

  // ========== åŸºç¡€ä¿¡æ¯ï¼ˆè‹±æ–‡ï¼Œä½œä¸ºå›é€€ï¼‰==========
  siteName        String  @map("site_name") // ç½‘ç«™åç§°ï¼šRunGame
  siteDescription String? @map("site_description") // ç½‘ç«™æè¿°
  siteUrl         String  @map("site_url") // ç½‘ç«™ URLï¼šhttps://rungame.online

  // ========== å“ç‰Œèµ„æº ==========
  logoUrl    String? @map("logo_url") // Logo URL
  faviconUrl String? @map("favicon_url") // Favicon URL
  ogImageUrl String? @map("og_image_url") // Open Graph é»˜è®¤å›¾ç‰‡

  // ========== è”ç³»æ–¹å¼ ==========
  contactEmail String? @map("contact_email") // è”ç³»é‚®ç®±
  supportEmail String? @map("support_email") // å®¢æœé‚®ç®±

  // ========== ç¤¾äº¤åª’ä½“é“¾æ¥ï¼ˆJSONï¼‰==========
  socialLinks Json? @default("{}") @map("social_links")
  // ç»“æ„ç¤ºä¾‹ï¼š
  // {
  //   "twitter": "https://twitter.com/rungame",
  //   "facebook": "https://facebook.com/rungame",
  //   "discord": "https://discord.gg/rungame",
  //   "youtube": "https://youtube.com/@rungame"
  // }

  // ========== SEO é…ç½® ==========
  defaultKeywords String[] @default([]) @map("default_keywords") // é»˜è®¤ SEO å…³é”®è¯
  twitterHandle   String?  @map("twitter_handle") // Twitter è´¦å·ï¼š@rungame

  // ========== ç¬¬ä¸‰æ–¹æœåŠ¡ ==========
  googleAnalyticsId String? @map("google_analytics_id") // GA IDï¼šG-XXXXXXXXXX
  googleAdsenseId   String? @map("google_adsense_id") // AdSense IDï¼šca-pub-XXXX

  // ========== è‡ªå®šä¹‰è„šæœ¬ï¼ˆJSONï¼‰==========
  customScripts Json? @default("{}") @map("custom_scripts")
  // ç»“æ„ç¤ºä¾‹ï¼š
  // {
  //   "headScripts": ["<script>...</script>"],
  //   "bodyScripts": ["<script>...</script>"]
  // }

  // ========== åŠŸèƒ½å¼€å…³ ==========
  maintenanceMode Boolean @default(false) @map("maintenance_mode") // ç»´æŠ¤æ¨¡å¼
  enableComments  Boolean @default(false) @map("enable_comments") // å¯ç”¨è¯„è®º
  enableRatings   Boolean @default(true) @map("enable_ratings") // å¯ç”¨è¯„åˆ†

  // ========== å…¶ä»–é…ç½®ï¼ˆJSONï¼‰==========
  extraConfig Json? @default("{}") @map("extra_config")
  // å¯å­˜å‚¨ä»»æ„é¢å¤–é…ç½®

  // ========== æ—¶é—´æˆ³ ==========
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // ========== å…³è”å…³ç³» ==========
  translations SiteConfigTranslation[]

  @@map("site_configs")
}

// ç½‘ç«™é…ç½®ç¿»è¯‘è¡¨
model SiteConfigTranslation {
  id           String @id @default(cuid())
  siteConfigId String @map("site_config_id")
  locale       String

  // ç¿»è¯‘å­—æ®µ
  siteName        String // ç½‘ç«™åç§°ç¿»è¯‘
  siteDescription String? // ç½‘ç«™æè¿°ç¿»è¯‘
  keywords        String[] @default([]) // è¯¥è¯­è¨€çš„ SEO å…³é”®è¯

  // æ—¶é—´æˆ³
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // å…³è”å…³ç³»
  siteConfig SiteConfig @relation(fields: [siteConfigId], references: [id], onDelete: Cascade)

  @@unique([siteConfigId, locale])
  @@index([locale])
  @@map("site_config_translations")
}

// ========================================
// æ¸¸æˆæŠ•ç¥¨è®°å½•è¡¨ï¼ˆé˜²é‡å¤æŠ•ç¥¨ï¼‰
// ========================================
model GameVote {
  id        String   @id @default(cuid())
  gameId    String   @map("game_id")
  userIp    String   @map("user_ip") // ç”¨æˆ·IPåœ°å€
  isLike    Boolean  @map("is_like") // true=èµ, false=è¸©
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // å…³è”å…³ç³»
  game Game @relation(fields: [gameId], references: [id], onDelete: Cascade)

  @@unique([gameId, userIp]) // æ¯ä¸ªIPå¯¹æ¯ä¸ªæ¸¸æˆåªèƒ½æŠ•ä¸€ç¥¨
  @@index([gameId])
  @@index([userIp])
  @@index([createdAt])
  @@map("game_votes")
}

// ==================== SEO URLæäº¤ç³»ç»Ÿ ====================

// æœç´¢å¼•æ“é…ç½®è¡¨
model SearchEngineConfig {
  id String @id @default(cuid())

  // ========== åŸºæœ¬ä¿¡æ¯ ==========
  name String // æœç´¢å¼•æ“åç§°ï¼šBing, Baidu, Yandex, Google
  slug String  @unique // æ ‡è¯†ç¬¦ï¼šbing-indexnow, baidu, yandex, google
  type String // ç±»å‹ï¼šindexnow, baidu, google, custom
  icon String? // å›¾æ ‡URLæˆ–emoji (ğŸ”, ğŸŒ)

  description String? // æè¿°ä¿¡æ¯

  // ========== APIé…ç½® ==========
  apiEndpoint String  @map("api_endpoint") // APIç«¯ç‚¹URL
  apiKey      String? @map("api_key") // APIå¯†é’¥ï¼ˆéœ€åŠ å¯†å­˜å‚¨ï¼‰
  apiToken    String? @map("api_token") // APIä»¤ç‰Œï¼ˆç™¾åº¦ä½¿ç”¨ï¼‰
  siteUrl     String? @map("site_url") // ç½‘ç«™URLï¼ˆç™¾åº¦éœ€è¦ï¼‰

  // ========== é¢å¤–é…ç½®ï¼ˆJSONï¼‰==========
  extraConfig Json? @default("{}") @map("extra_config")

  // ========== çŠ¶æ€é…ç½® ==========
  isEnabled  Boolean @default(true) @map("is_enabled") // æ˜¯å¦å¯ç”¨
  autoSubmit Boolean @default(false) @map("auto_submit") // æ˜¯å¦è‡ªåŠ¨æäº¤ï¼ˆå†…å®¹å‘å¸ƒæ—¶ï¼‰
  sortOrder  Int     @default(0) @map("sort_order") // æ˜¾ç¤ºæ’åº

  // ========== ç»Ÿè®¡æ•°æ® ==========
  totalSubmitted Int       @default(0) @map("total_submitted") // æ€»æäº¤URLæ•°
  totalSuccess   Int       @default(0) @map("total_success") // æ€»æˆåŠŸæ•°
  totalFailed    Int       @default(0) @map("total_failed") // æ€»å¤±è´¥æ•°
  lastSubmitAt   DateTime? @map("last_submit_at") // æœ€åæäº¤æ—¶é—´

  // ========== æ—¶é—´æˆ³ ==========
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@index([slug])
  @@index([type])
  @@index([isEnabled])
  @@index([autoSubmit])
  @@index([sortOrder])
  @@map("search_engine_configs")
}

// URLæäº¤è®°å½•è¡¨
model UrlSubmission {
  id String @id @default(cuid())

  // ========== åŸºæœ¬ä¿¡æ¯ ==========
  url      String  // å®Œæ•´URLï¼ŒåŒ…å«è¯­è¨€å‰ç¼€ï¼šhttps://rungame.online/zh/play/puzzle-game
  urlType  String  @map("url_type") // URLç±»å‹ï¼šgame, category, tag, pagetype, sitemap, other
  entityId String? @map("entity_id") // å…³è”å®ä½“IDï¼ˆæ¸¸æˆIDã€åˆ†ç±»IDç­‰ï¼‰ï¼Œç”¨äºæ‰¹é‡æ“ä½œå’Œæ•°æ®æ¸…ç†
  locale   String? // è¯­è¨€ä»£ç ï¼šen, zh, esï¼ˆä»…ä½œæ ‡è®°ï¼Œç”¨äºå‰ç«¯ç­›é€‰å’Œç»Ÿè®¡ï¼‰

  // ========== Google æäº¤çŠ¶æ€ ==========
  googleSubmitStatus        SubmissionStatus? @map("google_submit_status")
  googleSubmitStatusMessage String?           @map("google_submit_status_message")
  googleSubmitHttpStatus    Int?              @map("google_submit_http_status")
  googleSubmitResponseBody  String?           @map("google_submit_response_body")
  googleSubmitResponseTime  Int?              @map("google_submit_response_time")
  googleSubmittedAt         DateTime?         @map("google_submitted_at")

  // ========== Bing æäº¤çŠ¶æ€ ==========
  bingSubmitStatus        SubmissionStatus? @map("bing_submit_status")
  bingSubmitStatusMessage String?           @map("bing_submit_status_message")
  bingSubmitHttpStatus    Int?              @map("bing_submit_http_status")
  bingSubmitResponseBody  String?           @map("bing_submit_response_body")
  bingSubmitResponseTime  Int?              @map("bing_submit_response_time")
  bingSubmittedAt         DateTime?         @map("bing_submitted_at")

  // ========== Google æ”¶å½•çŠ¶æ€ ==========
  indexedByGoogle      Boolean?  @map("indexed_by_google") // å¿«é€ŸæŸ¥è¯¢å­—æ®µï¼ˆverdict === 'PASS'ï¼‰
  googleIndexedAt      DateTime? @map("google_indexed_at")
  googleLastCheckAt    DateTime? @map("google_last_check_at")
  googleCheckMessage   String?   @map("google_check_message")
  googleIndexStatusRaw Json?     @map("google_index_status_raw") // å­˜å‚¨å®Œæ•´çš„ API å“åº”ä¿¡æ¯
  // googleIndexStatusRaw ç»“æ„ç¤ºä¾‹:
  // {
  //   "verdict": "PASS" | "FAIL" | "NEUTRAL",
  //   "indexingState": "INDEXING_ALLOWED" | "BLOCKED_BY_META_TAG" | "BLOCKED_BY_HTTP_HEADER",
  //   "coverageState": "Submitted and indexed" | "Crawled - currently not indexed",
  //   "pageFetchState": "...",
  //   "robotsTxtState": "...",
  //   "lastCrawlTime": "..."
  // }

  // ========== Bing æ”¶å½•çŠ¶æ€ ==========
  indexedByBing      Boolean?  @map("indexed_by_bing") // å¿«é€ŸæŸ¥è¯¢å­—æ®µ
  bingIndexedAt      DateTime? @map("bing_indexed_at")
  bingLastCheckAt    DateTime? @map("bing_last_check_at")
  bingCheckMessage   String?   @map("bing_check_message")
  bingIndexStatusRaw Json?     @map("bing_index_status_raw") // å­˜å‚¨å®Œæ•´çš„ API å“åº”ä¿¡æ¯

  // ========== æ—¶é—´æˆ³ ==========
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // ========== ç´¢å¼• ==========
  @@unique([url], name: "unique_url") // URL æœ¬èº«å·²åŒ…å«è¯­è¨€å‰ç¼€ï¼Œä¿è¯å…¨å±€å”¯ä¸€
  @@index([url])
  @@index([urlType])
  @@index([entityId])
  @@index([locale])
  @@index([indexedByGoogle])
  @@index([indexedByBing])
  @@index([googleLastCheckAt])
  @@index([bingLastCheckAt])
  @@index([createdAt])
  @@map("url_submissions")
}

// æ‰¹é‡æäº¤ä»»åŠ¡è¡¨
model SubmissionBatch {
  id String @id @default(cuid())

  // ========== æ‰¹æ¬¡ä¿¡æ¯ ==========
  name        String // æ‰¹æ¬¡åç§°ï¼šå¦‚ "å‘å¸ƒæ‰€æœ‰æ¸¸æˆåˆ°Bing"
  description String? // æ‰¹æ¬¡æè¿°
  status      BatchStatus @default(PENDING)

  // ========== ç»Ÿè®¡ä¿¡æ¯ ==========
  totalUrls     Int @default(0) @map("total_urls") // æ€»URLæ•°
  processedUrls Int @default(0) @map("processed_urls") // å·²å¤„ç†æ•°
  successUrls   Int @default(0) @map("success_urls") // æˆåŠŸæ•°
  failedUrls    Int @default(0) @map("failed_urls") // å¤±è´¥æ•°
  pendingUrls   Int @default(0) @map("pending_urls") // å¾…å¤„ç†æ•°

  // ========== é…ç½®ä¿¡æ¯ ==========
  searchEngineConfigIds String[] @default([]) @map("search_engine_config_ids") // ç›®æ ‡æœç´¢å¼•æ“IDåˆ—è¡¨

  // URLç­›é€‰æ¡ä»¶ï¼ˆJSONï¼‰
  urlFilters Json? @default("{}") @map("url_filters")

  // ========== æ‰§è¡Œä¿¡æ¯ ==========
  startedAt   DateTime? @map("started_at") // å¼€å§‹å¤„ç†æ—¶é—´
  completedAt DateTime? @map("completed_at") // å®Œæˆæ—¶é—´
  cancelledAt DateTime? @map("cancelled_at") // å–æ¶ˆæ—¶é—´

  errorMessage String? @map("error_message") // é”™è¯¯ä¿¡æ¯ï¼ˆå¦‚æœå¤±è´¥ï¼‰

  createdBy String @map("created_by") // åˆ›å»ºäººï¼ˆç®¡ç†å‘˜IDæˆ– "system"ï¼‰

  // ========== æ—¶é—´æˆ³ ==========
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@index([status])
  @@index([createdAt])
  @@index([createdBy])
  @@map("submission_batches")
}
